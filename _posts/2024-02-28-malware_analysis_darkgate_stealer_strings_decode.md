---
title:  "Malware Analysis - DarkGate stealer strings decode"
date:   2024-02-28 13:56:00 +0300
author: cozy
categories: [malware, stealer]
---

## Introduction

ну кароч я хочу зачекать радамантус стилер потому что он пиздец ахуенно выглядит, прям ебануто. Но пока что вот мини скрипт чтоб подекодить строки для даркгейта

## Decoding
На самом деле все строки это base64 + custom alphabet. То есть не оч сложно поэтому вот

```python
import base64
import idautils  
import idc  
import ida_idaapi, ida_kernwin, ida_bytes, ida_name

decrFunction = 0x #placeDecryptionFuncHere 
custom_alphabet = 'placeAlphabetHere'
decrypted_strings = []

def customBase64(encoded_data, custom_alphabet):
    standard_alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'
    translation_table = str.maketrans(custom_alphabet, standard_alphabet)
    translated_data = encoded_data.translate(translation_table)
    padding = len(translated_data) % 4
    if padding != 0:
        translated_data += "=" * (4 - padding)
    try:
        decoded_data = base64.b64decode(translated_data)
    except Exception as error:
        raise ValueError(f"Error while decoding: {error}")
    return decoded_data

def decodeStrings(Decryption_routin):
    Xrefs = idautils.CodeRefsTo(Decryption_routin,0)  
    count=0  
    for x in Xrefs:
        hyiii = ""
        ea = idc.prev_head(x)
        operand_address = idc.get_operand_value(ea,1)
        enc_string = idc.get_strlit_contents(operand_address).decode('utf-8')
        enc_string = customBase64(enc_string, custom_alphabet)
        decrypted_strings.append(enc_string)
        try:
            hyiii += enc_string.decode('utf-8')
        except UnicodeDecodeError:
            continue
        idc.set_cmt(x,hyiii,0)
        
decodeStrings(decrFunction)
```

спасибо за просмотр ставьте лайки комментарии с вами был мистер бист всем пока
